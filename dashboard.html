<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Dashboard - CATY</title>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getAuth, onAuthStateChanged, signOut }
from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";

import {
  getFirestore,
  collection,
  query,
  where,
  getDocs
} from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

const firebaseConfig={
  apiKey:"AIzaSyCAE8_fQ8f8ElDWmxZCws6oGrnaSbaK1ZE",
  authDomain:"business-saas-cc546.firebaseapp.com",
  projectId:"business-saas-cc546"
};

const app=initializeApp(firebaseConfig);
const auth=getAuth(app);
const db=getFirestore(app);

onAuthStateChanged(auth, async user=>{
  if(!user){
    window.location.href="login.html";
  }else{

    const q=query(collection(db,"businesses"),where("ownerId","==",user.uid));
    const snap=await getDocs(q);

    if(snap.empty){
      window.location.href="create-business.html";
      return;
    }

    snap.forEach(doc=>{
      const data=doc.data();
      document.getElementById("businessName").innerText=data.name;
      document.getElementById("businessCategory").innerText=data.category;
      document.getElementById("businessCurrency").innerText=data.currency;
    });

  }
});

window.logout=function(){
  signOut(auth).then(()=>window.location.href="index.html");
};
</script>

<style>
body{margin:0;font-family:Arial;background:#0F172A;color:white}
.sidebar{width:200px;background:#111827;height:100vh;padding:20px;position:fixed}
.sidebar a{display:block;color:white;margin-bottom:10px;text-decoration:none}
.main{margin-left:220px;padding:30px}
.card{background:#111827;padding:20px;border-radius:10px;margin-bottom:20px}
button{padding:8px 15px;background:#4F46E5;border:none;color:white;border-radius:20px}
</style>
</head>

<body>

<div class="sidebar">
<h3>CATY</h3>
<a href="dashboard.html">Dashboard</a>
<a href="clients.html">Clients</a>
<a href="#" onclick="logout()">Logout</a>
</div>

<div class="main">

<h2 id="businessName">Loading...</h2>

<div class="card">
<p>Category: <span id="businessCategory"></span></p>
<p>Currency: <span id="businessCurrency"></span></p>
</div>

<div class="card">
<h3>System Status</h3>
<p>Caty Internal Business Robo is active.</p>
</div>

</div>

</body>
</html>
